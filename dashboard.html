<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pastosano Dashboard</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/recharts@2.8.0/umd/Recharts.js"></script>
    <script src="https://unpkg.com/lucide-react@0.263.1/dist/umd/lucide-react.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState } = React;
        const { BarChart, Bar, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer, LineChart, Line } = Recharts;
        const { Calendar, Users, ShoppingBag, TrendingUp, Clock, CheckCircle, XCircle, Eye, FileText, Printer } = LucideReact;
        const { jsPDF } = window.jspdf;

        const PastosanoDashboard = () => {
            const [activeTab, setActiveTab] = useState('overview');
            const [selectedOrder, setSelectedOrder] = useState(null);
            const [isOrderModalOpen, setIsOrderModalOpen] = useState(false);
            const [selectedOrdersForPdf, setSelectedOrdersForPdf] = useState(new Set());

            // Dati mock
            const todayStats = {
                reservations: 24,
                orders: 18,
                revenue: 650,
                satisfaction: 4.8
            };

            const weeklyData = [
                { day: 'Lun', ordini: 12, fatturato: 340 },
                { day: 'Mar', ordini: 19, fatturato: 520 },
                { day: 'Mer', ordini: 15, fatturato: 410 },
                { day: 'Gio', ordini: 22, fatturato: 680 },
                { day: 'Ven', ordini: 28, fatturato: 890 },
                { day: 'Sab', ordini: 35, fatturato: 1250 },
                { day: 'Dom', ordini: 18, fatturato: 650 }
            ];

            const reservations = [
                { id: 1, customer: 'Mario Rossi', time: '19:30', guests: 4, status: 'confermata' },
                { id: 2, customer: 'Anna Verdi', time: '20:00', guests: 2, status: 'in-attesa' },
                { id: 3, customer: 'Luca Bianchi', time: '20:30', guests: 6, status: 'confermata' },
                { id: 4, customer: 'Sofia Neri', time: '21:00', guests: 3, status: 'annullata' }
            ];

            const orders = [
                {
                    id: 1,
                    customer: 'Mario Rossi',
                    time: '19:45',
                    status: 'preparazione',
                    total: 45.50,
                    items: [
                        { name: 'Spaghetti Carbonara', quantity: 2, price: 12.00 },
                        { name: 'Tiramisu', quantity: 1, price: 6.50 },
                        { name: 'Vino Rosso', quantity: 1, price: 15.00 }
                    ]
                },
                {
                    id: 2,
                    customer: 'Anna Verdi',
                    time: '20:15',
                    status: 'servito',
                    total: 28.00,
                    items: [
                        { name: 'Pizza Margherita', quantity: 1, price: 8.00 },
                        { name: 'Insalata Mista', quantity: 1, price: 6.00 },
                        { name: 'Acqua', quantity: 2, price: 4.00 },
                        { name: 'Caffe', quantity: 2, price: 3.00 }
                    ]
                },
                {
                    id: 3,
                    customer: 'Luca Bianchi',
                    time: '20:45',
                    status: 'completato',
                    total: 65.00,
                    items: [
                        { name: 'Antipasto Misto', quantity: 1, price: 15.00 },
                        { name: 'Bistecca alla Griglia', quantity: 2, price: 22.00 },
                        { name: 'Contorno di Verdure', quantity: 2, price: 8.00 }
                    ]
                }
            ];

            const generateOrdersPDF = () => {
                if (selectedOrdersForPdf.size === 0) {
                    alert('Seleziona almeno un ordine per creare il PDF');
                    return;
                }

                try {
                    const doc = new jsPDF();
                    const selectedOrders = orders.filter(order => selectedOrdersForPdf.has(order.id));
                    
                    // Header
                    doc.setFontSize(20);
                    doc.text('ORDINI PASTO SANO - FORNITORE', 20, 20);
                    
                    doc.setFontSize(12);
                    doc.text(`Data: ${new Date().toLocaleDateString('it-IT')}`, 20, 30);
                    doc.text(`Ordini selezionati: ${selectedOrders.length}`, 20, 40);
                    
                    let yPosition = 60;
                    
                    selectedOrders.forEach((order, index) => {
                        // Numero ordine
                        doc.setFontSize(12);
                        doc.setFont(undefined, 'bold');
                        doc.text(`${index + 1}. #ORD${order.id.toString().padStart(6, '0')}`, 20, yPosition);
                        yPosition += 8;
                        
                        // Nome cliente
                        doc.setFontSize(11);
                        doc.setFont(undefined, 'normal');
                        doc.text(`- ${order.customer}`, 25, yPosition);
                        yPosition += 6;
                        
                        // Orario
                        doc.text(`Orario: ${order.time}`, 25, yPosition);
                        yPosition += 6;
                        
                        // Prodotti
                        doc.text(`Prodotti:`, 25, yPosition);
                        yPosition += 6;
                        
                        order.items.forEach((item) => {
                            const itemText = `  ${item.name} (x${item.quantity})`;
                            doc.text(itemText, 30, yPosition);
                            yPosition += 5;
                        });
                        
                        yPosition += 8;
                        
                        // Nuova pagina se necessario
                        if (yPosition > 250 && index < selectedOrders.length - 1) {
                            doc.addPage();
                            yPosition = 20;
                        }
                    });
                    
                    doc.save('ordini-selezionati.pdf');
                } catch (error) {
                    console.error('Errore nella generazione del PDF:', error);
                    alert('Errore nella generazione del PDF');
                }
            };

            const toggleOrderSelection = (orderId) => {
                const newSelection = new Set(selectedOrdersForPdf);
                if (newSelection.has(orderId)) {
                    newSelection.delete(orderId);
                } else {
                    newSelection.add(orderId);
                }
                setSelectedOrdersForPdf(newSelection);
            };

            const openOrderModal = (order) => {
                setSelectedOrder(order);
                setIsOrderModalOpen(true);
            };

            const getStatusIcon = (status) => {
                switch (status) {
                    case 'preparazione':
                        return React.createElement(Clock, { className: "text-yellow-500", size: 16 });
                    case 'servito':
                        return React.createElement(CheckCircle, { className: "text-green-500", size: 16 });
                    case 'completato':
                        return React.createElement(CheckCircle, { className: "text-blue-500", size: 16 });
                    default:
                        return React.createElement(XCircle, { className: "text-red-500", size: 16 });
                }
            };

            const getStatusColor = (status) => {
                switch (status) {
                    case 'confermata':
                        return 'bg-green-100 text-green-800';
                    case 'in-attesa':
                        return 'bg-yellow-100 text-yellow-800';
                    case 'annullata':
                        return 'bg-red-100 text-red-800';
                    default:
                        return 'bg-gray-100 text-gray-800';
                }
            };

            return React.createElement('div', { className: "min-h-screen bg-gray-50" },
                // Header
                React.createElement('header', { className: "bg-white shadow-sm border-b border-gray-200" },
                    React.createElement('div', { className: "max-w-7xl mx-auto px-4 sm:px-6 lg:px-8" },
                        React.createElement('div', { className: "flex justify-between items-center py-4" },
                            React.createElement('div', { className: "flex items-center" },
                                React.createElement('h1', { className: "text-2xl font-bold text-gray-900" }, 'Pastosano'),
                                React.createElement('span', { className: "ml-2 text-sm text-gray-500" }, 'Dashboard')
                            ),
                            React.createElement('div', { className: "flex items-center space-x-4" },
                                React.createElement('span', { className: "text-sm text-gray-600" },
                                    new Date().toLocaleDateString('it-IT', { 
                                        weekday: 'long', 
                                        year: 'numeric', 
                                        month: 'long', 
                                        day: 'numeric' 
                                    })
                                )
                            )
                        )
                    )
                ),

                // Navigation
                React.createElement('nav', { className: "bg-white shadow-sm" },
                    React.createElement('div', { className: "max-w-7xl mx-auto px-4 sm:px-6 lg:px-8" },
                        React.createElement('div', { className: "flex space-x-8" },
                            [
                                { id: 'overview', label: 'Panoramica', icon: TrendingUp },
                                { id: 'reservations', label: 'Prenotazioni', icon: Calendar },
                                { id: 'orders', label: 'Ordini', icon: ShoppingBag },
                                { id: 'menu', label: 'Menu', icon: FileText }
                            ].map((tab) =>
                                React.createElement('button', {
                                    key: tab.id,
                                    onClick: () => setActiveTab(tab.id),
                                    className: `flex items-center px-3 py-4 text-sm font-medium border-b-2 ${
                                        activeTab === tab.id
                                            ? 'border-orange-500 text-orange-600'
                                            : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'
                                    }`
                                },
                                    React.createElement(tab.icon, { className: "mr-2", size: 18 }),
                                    tab.label
                                )
                            )
                        )
                    )
                ),

                // Main Content
                React.createElement('main', { className: "max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8" },
                    activeTab === 'orders' && React.createElement('div', { className: "space-y-6" },
                        React.createElement('div', { className: "bg-white rounded-lg shadow p-6" },
                            React.createElement('div', { className: "flex justify-between items-center mb-4" },
                                React.createElement('h3', { className: "text-lg font-semibold text-gray-800" }, 'Ordini Recenti'),
                                React.createElement('div', { className: "flex gap-2" },
                                    React.createElement('button', {
                                        onClick: generateOrdersPDF,
                                        className: "bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg flex items-center gap-2 text-sm"
                                    },
                                        React.createElement(Printer, { size: 16 }),
                                        `PDF Ordini (${selectedOrdersForPdf.size})`
                                    )
                                )
                            ),
                            React.createElement('div', { className: "space-y-4" },
                                orders.map((order) =>
                                    React.createElement('div', { 
                                        key: order.id, 
                                        className: "border border-gray-200 rounded-lg p-4" 
                                    },
                                        React.createElement('div', { className: "flex items-center justify-between" },
                                            React.createElement('div', { className: "flex items-center gap-3" },
                                                React.createElement('input', {
                                                    type: "checkbox",
                                                    checked: selectedOrdersForPdf.has(order.id),
                                                    onChange: () => toggleOrderSelection(order.id),
                                                    className: "w-4 h-4 text-green-600 rounded"
                                                }),
                                                React.createElement('div', null,
                                                    React.createElement('h4', { className: "font-medium text-gray-800" }, order.customer),
                                                    React.createElement('p', { className: "text-sm text-gray-600" }, order.time)
                                                )
                                            ),
                                            React.createElement('div', { className: "flex items-center space-x-4" },
                                                React.createElement('div', { className: "flex items-center space-x-2" },
                                                    getStatusIcon(order.status),
                                                    React.createElement('span', { className: "text-sm font-medium" }, order.status)
                                                ),
                                                React.createElement('span', { className: "text-sm font-bold" }, `â‚¬${order.total.toFixed(2)}`),
                                                React.createElement('button', {
                                                    onClick: () => openOrderModal(order),
                                                    className: "text-blue-600 hover:text-blue-800"
                                                },
                                                    React.createElement(Eye, { size: 16 })
                                                )
                                            )
                                        )
                                    )
                                )
                            )
                        )
                    ),

                    activeTab !== 'orders' && React.createElement('div', { className: "text-center py-8" },
                        React.createElement('p', { className: "text-gray-600" }, `Sezione ${activeTab} in sviluppo...`)
                    )
                )
            );
        };

        ReactDOM.render(React.createElement(PastosanoDashboard), document.getElementById('root'));
    </script>
</body>
</html>